# Тестовое задание по android

**Автор:**  Кочкарева Елизавета Игоревна, УлГТУ, ПИбд-42

**Задание:** https://drive.google.com/file/d/1RslvmHpry1GKUjYQ5NOImQlJQv591BOA/view

## Содержание

* [Как запустить](#как-запустить)
* [Описание проекта](#Описание-проекта)
* [Структура проекта](#структура-проекта)
* [Используемые зависимости](#используемые-зависимости)
* [Использование](#использование)
    * [Элементы экрана](#элементы-экрана)
    * [Запуск приложения](#запуск-приложения)
    * [Удаление элементов](#удаление-элементов)
* [Стек технологий](#стек-технологий)
* [Используемые источники](#используемые-источники)


## Как запустить

Для запуска приложения на Flutter, выполните следующие шаги:

1. **Установите Flutter SDK**: Убедитесь, что у вас установлен Flutter SDK на вашем компьютере. Можно скачать Flutter [здесь](https://flutter.dev/docs/get-started/install).

2. **Настройте среду разработки**: Используйте любую удобную вам интегрированную среду разработки (IDE), такую как Android Studio, Visual Studio Code или IntelliJ IDEA.

3. **Подключите устройство или эмулятор**: Запустите эмулятор устройства Android или подключите физическое устройство к компьютеру.

4. **Клонируйте репозиторий**: Склонируйте репозиторий с проектом Flutter с помощью команды:

```bash
git clone https://github.com/Kochkareva/practice.git
```

5. **Откройте проект**: Откройте корневую папку проекта `practice` в выбранной IDE.

6. **Запустите приложение**: Выберите устройство для запуска (эмулятор или физическое устройство) и нажмите кнопку `Run` или выполните команду `flutter run` в терминале.

После выполнения этих шагов приложение Flutter должно успешно запуститься на выбранном устройстве.


## Описание проекта

Приложение *"Flutter-Poke"* позволяет просматривать список покемонов и удалять несколько выбранных из них. Элементы загружаются по Rest с пагинацией из *[PokeAPI](https://pokeapi.co/api/v2/)*. В приложении один экран.


## Структура проекта

Структура проекта выглядит следующим образом:

```
practice
|_ android
|_ assets
|_ ios
|_ lib
    |_ api_service
        |_ api_service.dart
    |_ constants
        |_ api_constants.dart
    |_ models
        |_ pokemon_model.dart
        |_ pokemon_model.g.dart
    |_ pages
        |_ product_page.dart
    |_ storages
        |_ pokemon_storage.dart
    |_ main.dart
|_ test
|_ web
|_ pubspec.yaml
```
В файле [api_service.dart](/lib/api_service/api_service.dart) содерижится класс для выполнения запросов к Api. Запросы к Api реализуются методами класса: 
 - `Future<List<PokemonModel>?> getPokemons(int page)` - загрузки списка элементов с сервера.
 - `Future<void> deletePokemonsAPI(List<int> indexes)` - удаления элементов списка с сервера.

> [!NOTE]
> Поскольку в *PokeApi* отсутствует запрос на удаление, успешность удаления 
> с сервера реализуется рандомом для имитации ошибок:
> 
>```dart
>true - statusCode = 200
>false - statusCode = 400
>```

В файле [api_constants.dart](/lib/constants/api_constants.dart) содержится класс для хранения констант, связанных с API.

В файле [pokemon_model.dart](/lib/models/pokemon_model.dart) содержит модель `PokemonModel` и методы для десериализации JSON в модель данных.

В файле [product_page.dart](/lib/pages/product_page.dart) содержатся классы визуальных элементов экрана и методы управления ими.

В файле [pokemon_storage.dart](/lib/storages/pokemon_storage.dart) содержатся методы управления локальным хранилищем.

Файл [main.dart](/lib/main.dart) является точкой входа в приложение, где находится главный метод `main()`. Этот файл содержит основной код приложения и выступает отправной точкой для его запуска.

## Используемые зависимости

Список необходимых зависимостей или программного обеспечения для запуска проекта находится в файле [pubspec.yaml](/pubspec.yaml).

Приложение использует внешние библиотеки:
- `provider: ^6.0.0` - оболочка базового класса виджетов `InheritedWidget`, для упрощения их использования и возможности многократного использования. [Документация](https://pub.dev/packages/provider). 
- `http: ^0.13.4` - набор высокоуровневых функций и классов, которые упрощают использование ресурсов HTTP. [Документация](https://pub.dev/packages/http).
- `hive: ^2.2.3, hive_flutter: ^1.1.0, hive_generator: any` - NoSQL база данных ключей и значений. [Документация](https://pub.dev/packages/hive).
- `path_provider: ^2.0.14` - упрощает взаимодействие с файловой системой в приложениях. [Документация](https://pub.dev/packages/path_provider).
- `cupertino_icons: ^1.0.2` - набор ресурсов значков по умолчанию, используемый `Cupertino widgets` от Flutter. [Документация](https://pub.dev/packages/cupertino_icons).


## Использование

### Элементы экрана

1. Список:
    * Элемент списка;
	* Элемент списка (лоадер), визуализирующий загрузку следующей страницы;
	* Элемент списка (ошибка), визуализирующий ошибку загрузки последней страницы.
2. Лоадер `SwipeToRefresh` для перезагрузки списка.
3. `SnackBar` для отображения ошибок при удалении элементов
Кнопка для удаления выбранных элементов.


### Запуск приложения

При запуска приложение отображает закешированный из предыдущей сессии список, одновременно начинает перезагрузку списка с сервера (загружает первую порцию) и отображает загрузку посредством лоадера 2 последнем элементов в списке.

<div style="desplay: flex; justify-content: space-around">
<img src="/screenshots/pic1.jpg" width="200">
</img>

<img src="/screenshots/pic2.jpg" width="200">
</img>
</div>

*Список покемонов и Процесс подгрузки данных.*

Далее:
* Если перезагрузка прошла успешно - закешированный список заменяется актуальным. Если на сервере есть еще элементы - приложение отображает загрузку посредством лоадера 1.b последним элементом списка. 

* Если перезагрузка списка завершилась с ошибкой - приложение отображает ошибку посредством `SnackBar3` с кнопкой "Повторить". По кнопке "Повторить" попытка загрузки повторяется.

<img src="/screenshots/pic3.jpg" width="200"/>

*Ошибка перезагрузки списка.*

Как только пользователь по мере скролла приближается лоадеру 1.b (если он есть), приложение начинает подгружать последующую порцию элементов.
Далее:
* Если последующая порция прогрузилась успешно - новая порция отображается на экране. Далее если на сервере есть еще элементы - приложение отображает загрузку посредством лоадера 1.b последним элементов списка и так, пока не подгрузятся все порции.
* Отображение ошибки подгрузки очередной порции:
    * Если список на экране пуст - `SnackBar3` с бесконечной продолжительностью с кнопкой "Повторить".

    <img src="/screenshots/pic3.jpg" width="200"/>
    
    *Ошибка подгрузки порции данных.*
    
    * Если список не пуст - Ошибка 1.с последним элементов списка

    <img src="/screenshots/pic4.jpg" width="200"/>

    *Ошибка подгрузки порции данных.*

### Удаление элементов

Для выделения элементов используется долгое касание. Если элемент не был выбран - после долгого касания он становится выделенным. Если был - выделение снимается. Выделение отображается цветом.

<img src="/screenshots/pic5.jpg" width="200"/>

*Выделение элементов.*

Если появляются выбранные элементы - кнопка удаления 4 становится видимой. Если нет выделенных элементов - кнопка удаления 4 пропадает.

По нажатию на кнопку удаления 4 выделенные элементы сразу исчезают из списка (но только в контексте экрана, а не всего приложения). Далее:

Если удаление с сервера прошло успешно, элементы пропадают в контексте всего приложения.

<img src="/screenshots/pic6.jpg" width="200"/>

*Отсуствие удаленных элементов.*


Если удаление завершилось с ошибкой, то элементы возвращаются на экран (уже без выделения), а также отображается `SnackBar3` с кнопкой "Повторить" на непродолжительное время. По клику на кнопку "Повторить" операция повторяется.

<div style="desplay: flex; justify-content: space-around">
<img src="/screenshots/pic7.jpg" width="200">
</img>

<img src="/screenshots/pic8.jpg" width="200">
</img>
</div>

*Выбор элементов для удаления и Ошибка удаления элементов.*

Пользователь имеет возможность перезагрузить список, потянув лоадер `SwipeToRefrsh`.

<img src="/screenshots/pic9.jpg" width="200"/>

*Перезагрузка списка.*


## Стек технологий 

Приложение использует `Dart SDK` версии 3.2.6 и `flutter` версии 3.16.9.

Разработка приложения полностью велась в интегрированной среде разработки `Android Studio CE`.

## Используемые источники

- Официальная документация *[PokeAPI](https://pokeapi.co/)*.
- Официальная документация *[Dart и Flutter](https://pub.dev/)*.
- Официальная документация *[Flutter SDK](https://api.flutter.dev/index.html)*.